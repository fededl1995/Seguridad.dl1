<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Seguridad DL | Cat√°logo (Excel en vivo)</title>
  <meta name="description" content="Cat√°logo de seguridad cargado directamente desde un Excel. Reemplaz√° el Excel para actualizar precios." />
  <link rel="stylesheet" href="styles.css" />
  <!-- Librer√≠a para leer XLSX en el navegador (SheetJS) -->
  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js" Segurida dl></script>
  <script src="app.js" defer></script>
</head>
<body>
  <header class="topbar">
    <div class="container row">
      <div class="brand">
        <div class="logo" aria-hidden="true"></div>
        <div>
          <div>Deffer Tech</div>
          <div class="meta">Cat√°logo por categor√≠as ¬∑ datos le√≠dos desde <b>catalogo.xlsx</b></div>
        </div>
      </div>
      <div class="spacer"></div>
      <div class="row">
        <div class="badge" id="productsCount">Cargando‚Ä¶</div>
        <button class="btn" id="btnOpenCart" type="button">üõí Carrito (<span id="cartCount">0</span>)</button>
        <a class="btn primary" id="btnWhatsappTop" href="#" target="_blank" rel="noopener">üí¨ WhatsApp</a>
      </div>
    </div>
  </header>

  <main class="container">
    <section class="hero">
      <div class="hero-card">
        <h1>Cat√°logo por <span style="color:var(--accent2)">categor√≠a</span></h1>
        <p>
          Esta versi√≥n toma los datos directamente del Excel <b>catalogo.xlsx</b>.
          Para actualizar precios, reemplaz√° ese archivo y recarg√° la p√°gina.
        </p>

        <div class="kpis">
          <div class="kpi">
            <div class="val" id="kpiCategories">0</div>
            <div class="lbl">Categor√≠as</div>
          </div>
          <div class="kpi">
            <div class="val" id="kpiVisible">0</div>
            <div class="lbl">Mostrados (seg√∫n filtros)</div>
          </div>
          <div class="kpi">
            <div class="val" id="kpiTotal">0</div>
            <div class="lbl">Productos totales</div>
          </div>
        </div>
      </div>
    </section>

    <section class="panel" id="catalog">
      <div class="row">
        <div class="field" style="flex:1; min-width:260px;">
          <label for="q">Buscar</label>
          <input id="q" type="search" placeholder="Buscar por c√≥digo o descripci√≥n‚Ä¶" />
          <div class="small">Ej: ‚Äúxvr‚Äù, ‚Äúwifi‚Äù, ‚Äúportero‚Äù, ‚Äúenergizador‚Äù, ‚Äúipc‚Äù, ‚Äúdvr‚Äù.</div>
        </div>

        <div class="field">
          <label for="category">Categor√≠a</label>
          <select id="category"></select>
        </div>

        <div class="field">
          <label for="sort">Ordenar</label>
          <select id="sort">
            <option value="excel" selected>Orden del Excel</option>
            <option value="relevance">Relevancia (seg√∫n b√∫squeda)</option>
            <option value="priceAsc">Precio (menor a mayor)</option>
            <option value="priceDesc">Precio (mayor a menor)</option>
            <option value="codeAsc">C√≥digo A ‚Üí Z</option>
          </select>
        </div>

        <div class="field">
          <label>&nbsp;</label>
          <button class="btn" id="btnClear" type="button">Limpiar filtros</button>
        </div>
      </div>
      <div class="notice" id="runtimeNote" style="margin-top:12px; display:none;"></div>
    </section>

    <section id="grid" aria-live="polite">
      <div class="small" id="loadingMsg">Cargando cat√°logo desde el Excel‚Ä¶</div>
    </section>

    <section class="footer">
      <div class="small">
        <b>Importante:</b> Para que el navegador pueda leer <code>catalogo.xlsx</code>, abr√≠ esta web desde un <b>hosting</b> o un servidor local
        (no con doble click ‚Äúfile://‚Äù). En el ZIP te dejo c√≥mo hacerlo.
      </div>
    </section>
  </main>

  <!-- CART MODAL -->
  <div class="modal-backdrop" id="cartBackdrop" role="dialog" aria-modal="true" aria-label="Carrito">
    <div class="modal">
      <div class="modal-header">
        <div class="modal-title">üõí Carrito</div>
        <div class="spacer"></div>
        <button class="btn" id="btnCloseCart" type="button">Cerrar</button>
      </div>

      <div class="cart-items" id="cartItems"></div>

      <div class="totalbar">
        <div class="spacer"></div>
        <div class="sum" id="cartTotal">$0</div>
        <a class="btn primary" id="btnWhatsappCart" href="#" target="_blank" rel="noopener">Enviar pedido por WhatsApp</a>
      </div>

      <div class="notice">
        Los precios salen del Excel. Reemplaz√° <b>catalogo.xlsx</b> para actualizar.
      </div>
    </div>
  </div>
</body>
</html>
